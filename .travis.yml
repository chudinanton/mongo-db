language: python
python:
- '3.6'
install:
- pip install ansible>=2.4 molecule>=2.6 testinfra>=1.10 apache-libcloud requests google-auth pycrypto
env:
  matrix:
  matrix:
  - GCE_CREDENTIALS_FILE="$(pwd)/credentials.json"
  global:
  - secure: vnGXHhlu3LF0gmu247N+DoDEuJEb3OGvKceiQd2fbyoKb8QU+oZBBx2Yc/QHana/jmDDC08ZLAvfrYmrgbi5g+WaHBcK9bXE1WynJ6qeIrUjMAW8P+qfUZSmtylnEcVMDPsGgdtu//IkUPVAzdA4RfDEPw1Ar/AEmDmJx/uUEPy9FozeHokTaV+P7GqKYZb+jJRId0GkCFUIX9HkFXskKQKBbhEce6sA0D+mZy63t5SkUWtq1Ccdz2doyjRhZ4C1RkfYrzyzcIfTZF62IXCZCkMIf0epzkVdT+mhPWFdLZ9oTcrHY5D+u6BRDdfrdZPNyrWaNX72KfmLU3VO2yrePxQp99O2nwKCWOKwKHxujb/YIhiGRov9wgf08BrtKQr+n9lvFM6FapbU4XW8XR6X+L7X6hnFxZQQoPJ5Qi9+bwcmcBj1kQ0lKuIaeab3P6pfw4+TNj6lP2FZRDTkvlcUAl3uTDCKjloLvY/ytLGKfXkpA6N4Q5WPUUBOB5fFlss0096dBIP8FkStOeUCiMHV3qTL1tDXgpOoSM2mSwJv2FZW6VFe2tXWdESmbXslHMfxXOJ5yfx/NTtNXov5lFZE3rf91qb8VLGsvk6pf4sMkblm1XS6A1eepQAb00Yuy8/ugsYHDfsAuXjQNJa8JFbwnkuLDGdEnyZv3YWyICwvGJw=
  - secure: rylJS00JTQud4CdnCy+h1gkKb8Rgleu8sewdS0EzznlaaQpI4u4JT9oZxKMMYuveLTGfDINpJnYhOdkA8SMPhoNW3yAMIbhu2H2ru80mtVx2G/d3HcXxvbie6Vtr31JVstAca5bhxp8NTeZDjZeggzcF+4ROYjE61UNu0smfL7YyAzw8+kgsA0XN/Yo9l8nEBxoKrRuck2X2YAT13qja+kfSLoGoqHAwnTXvyrhhBemRswSUFwR0rbkwSPQpJnWaVYUOd0neCStjphJl92a5oSKslIpPXh+zUpH5pcWrHColm/IgVUMnpSpxG1x2xTnhomp+kifsZXbr/QY09BXJjduhtQ5l7Rkl9b5h3sKWKXwGBO7pLa3xdt7/uJ76+/ovIsi7vZ4M1W25Sfw9/++yhTulTwk272Fcb039n08M/ONW+SFX6inwqYXs8L2biHXVl9IRfNxLeygpwJw020ZaMO4V4QlTZBHv37opHytGNfNGbkpX47dpnFleA69cvZinFa9iaF07zOIKgSx9sr5xsjH1dADUaiEiwfLbYogLjyParyxs/c9p1+d3Bhi8S3pYe+D/8twU5CBUFMcpbMHBie1lR1YDe1isvX7ezAoMEDsZujWUwMBvD7UAgJJj01lCF9dlHEESncZWsQyySP8bmldsH26GrNhCaR8CvpSD1eQ=
  - secure: QCCSwCKjn0m0Od+HkGygYwBjYDdcp54Jbj6Ly0r+0pzx3NFjYYd9qBgIGwwf1MPCO53m7OQsjqhTi35x/HVb5lNZdQJGJAsrYFiH26fzbx5MYLOh1kR56G9Oqg6iJTVS0mCUoe9L/1Hr9sE/ZSMnkUX76OJGw2UgbLEgxnmy7RBjfY7LxiZm23MXRqNfhKN8OhBnISlaq+5eMV+1LyT06yt7Vc24aKlQ1lgUZqDro1JHvp6vjXc9TV0ZW44kRBzticmN81K39sWLFXwCdHJhoRADXQgFq/4gli1Bp89PMjhb0x7twyT+Cl2fnqKNNWyjIJ5/Yr6rQV58dT/1RWhunHsG2exz4hJ9uYMiTXFuGpmCKqOPMjs6ToL6Tt2RzjG7hk2ys8fxUIvAboeztQLWNy2Ha0iAqe/x+qbGkMkyUejShk/hMho40FMI/CWrVHUgHqK5DBK4C5pHzaRcUgiQilO+s0DoyTSllUuUETpWisDZjnFPFJF9AQuB88D09KCNbXW5MkliGr3iCl5wFA46Jq7/bsAIK/tdJKfpw5Rj8qvhrIwBvxXK2GYhNFzV4DDZqWS9qUyygUjRV+Lu1WKVNNhIR3a452CV2qGF96yreK0gqX8fUgx7fhXbjf9gSee/kXMK8P/iMTbfc/CWHnPn4xOmaJk+bOtJnKdfmfrB0OI=
script:
- molecule create
- molecule converge
- molecule verify
after_script:
- molecule destroy
before_install:
- openssl aes-256-cbc -K $encrypted_2db64f925e5c_key -iv $encrypted_2db64f925e5c_iv -in secrets.tar.enc -out secrets.tar -d
- tar xvf secrets.tar
- mv google_compute_engine /home/travis/.ssh/
- chmod 0600 /home/travis/.ssh/google_compute_engine
notifications:
  slack:
    rooms:
      secure: 4sOCWwyTyuY+v16FTf/wqymQTv/5Gt0OACRxuUn3h26ug6P4r9jBwDF1pO4Ymp4HFaWFszE4eCy8DxuqEgRQdL3y6DkGiFKanTRzYfcubvTZxG7RfmrQweFeUGPPv4QEjOxYPCXAqoqPE7dFTjAWcs6gxx+Q3XzOkHRU6bpY1RniwcJzuwSU9+8IZ+N8AaD9FZoGfWoq84cbpS+vSLfJiMOIOx9vj4fmVaOTZ3uhGrtXBFYQKT2pMfhHMPUjiamprNn4xLUMrga6rL5EGuHhg5PUv5U0xaFCqMT/7I442qXz9n2Fej6mTDOnoDbUq43nrqTRYcjDv168Jznb7AjKLK8O6z0sfKiL5L9D8h1jKBNHeVxmpg0Yk/gE5zS75VfN8kq918hv9t7ZLiYs4/Hip1Jnf0Inqy8/i61tazw+/oseMbP7dRkZHYaBQNRexKs31OjrYZoufIySI0ePM8D7sprJJjXzpaEwq380DNQhZyV+Y53cZOrkoxvJ1/Xvu6QB0BQqvxVYCqy6ScYLfJHjUKNDQyNV5P2vrEea21RLo1bnhmxLvgrF/vEnmJSe6nXnt/TQcBh4KbaZ4F7BcH7TW8caRSUldQr5Z+MXzzGQV5dYkVMR6qXzAV6IQujQkeCoopl4BkzsCBLOlge79guIRCm5snpmQk10xkRPHwgxAaU=
